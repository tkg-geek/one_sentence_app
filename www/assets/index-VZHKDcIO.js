const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-hijX2jpo.js","assets/index-DNjmFL_i.js","assets/index-PzudKucg.js"])))=>i.map(i=>d[i]);
(function(){const u=document.createElement("link").relList;if(u&&u.supports&&u.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))g(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const e of r.addedNodes)e.tagName==="LINK"&&e.rel==="modulepreload"&&g(e)}).observe(document,{childList:!0,subtree:!0});function c(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function g(i){if(i.ep)return;i.ep=!0;const r=c(i);fetch(i.href,r)}})();const f="modulepreload",v=function(d){return"/"+d},h={},p=function(u,c,g){let i=Promise.resolve();if(c&&c.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),t=(e==null?void 0:e.nonce)||(e==null?void 0:e.getAttribute("nonce"));i=Promise.allSettled(c.map(n=>{if(n=v(n),n in h)return;h[n]=!0;const o=n.endsWith(".css"),s=o?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${n}"]${s}`))return;const l=document.createElement("link");if(l.rel=o?"stylesheet":f,o||(l.as="script"),l.crossOrigin="",l.href=n,t&&l.setAttribute("nonce",t),document.head.appendChild(l),o)return new Promise((a,m)=>{l.addEventListener("load",a),l.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${n}`)))})}))}function r(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return i.then(e=>{for(const t of e||[])t.status==="rejected"&&r(t.reason);return u().catch(r)})};document.addEventListener("DOMContentLoaded",async()=>{console.log("DOM Content Loaded");try{let d,u,c;try{const r=await p(()=>import("./index-hijX2jpo.js"),__vite__mapDeps([0,1])),e=await p(()=>import("./index-PzudKucg.js"),__vite__mapDeps([2,1])),{registerPlugin:t}=await p(async()=>{const{registerPlugin:n}=await import("./index-DNjmFL_i.js");return{registerPlugin:n}},[]);d=r.App,u=e.Haptics,c=t("FullscreenPlugin",{web:{show:()=>Promise.reject("Web implementation not available"),hide:()=>Promise.reject("Web implementation not available")}}),console.log("FullscreenPlugin initialized:",c),console.log("Capacitor modules imported successfully")}catch(r){console.error("Capacitor import error:",r)}class g{constructor(){console.log("TextEditor constructor called"),this.init(),this.bindEvents(),this.initSortable(),this.setupKeyboardHandling()}init(){console.log("Initializing TextEditor"),this.textAreas=document.getElementById("textAreas"),this.addButton=document.getElementById("addButton"),this.saveButton=document.getElementById("saveButton"),this.deleteButton=document.getElementById("deleteButton"),this.playButton=document.getElementById("playButton"),console.log("Elements found:",{textAreas:!!this.textAreas,addButton:!!this.addButton,saveButton:!!this.saveButton,deleteButton:!!this.deleteButton,playButton:!!this.playButton}),this.loadFromStorage()}initSortable(){Sortable.create(this.textAreas,{animation:150,handle:".drag-handle",ghostClass:"dragging",dragClass:"dragging",onStart:e=>{e.item.classList.add("dragging")},onEnd:e=>{e.item.classList.remove("dragging")}})}bindEvents(){console.log("Binding events"),[{el:this.addButton,action:()=>this.addTextField(),id:"addButton"},{el:this.saveButton,action:()=>this.saveToStorage(),id:"saveButton"},{el:this.deleteButton,action:()=>this.clearStorage(),id:"deleteButton"},{el:this.playButton,action:()=>this.startFullscreen(),id:"playButton"}].forEach(({el:t,action:n,id:o})=>{if(!t){console.error(`Button ${o} not found`);return}console.log(`Setting up events for ${o}`);const s=l=>{console.log(`${o} action triggered`),l.preventDefault(),l.stopPropagation(),n()};if("ontouchstart"in window){let l=!1;t.addEventListener("touchstart",a=>{console.log(`${o} touchstart triggered`),l=!0,a.preventDefault(),a.stopPropagation(),t.style.opacity="0.7"},{passive:!1}),t.addEventListener("touchend",a=>{console.log(`${o} touchend triggered`),l&&(l=!1,a.preventDefault(),a.stopPropagation(),t.style.opacity="1.0",s(a))},{passive:!1}),t.addEventListener("touchcancel",a=>{console.log(`${o} touchcancel triggered`),l=!1,a.preventDefault(),a.stopPropagation(),t.style.opacity="1.0"})}t.addEventListener("click",s)}),console.log("Events binding completed"),this.setupClearButton(this.textAreas.querySelector(".text-container"))}isIOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}setupKeyboardHandling(){window.addEventListener("keyboardWillShow",()=>{document.body.classList.add("keyboard-visible"),this.adjustViewForKeyboard(!0)}),window.addEventListener("keyboardWillHide",()=>{document.body.classList.remove("keyboard-visible"),this.adjustViewForKeyboard(!1)}),document.addEventListener("focusin",e=>{e.target.classList.contains("text-input")&&this.adjustViewForKeyboard(!0)}),document.addEventListener("focusout",e=>{e.target.classList.contains("text-input")&&this.adjustViewForKeyboard(!1)})}adjustViewForKeyboard(e){const t=document.querySelector("main");if(e){const n=document.activeElement;n&&n.classList.contains("text-input")&&setTimeout(()=>{n.scrollIntoView({behavior:"smooth",block:"center"})},100),t.style.paddingBottom="200px"}else t.style.paddingBottom="0",window.scrollTo({top:0,behavior:"smooth"})}addTextField(){console.log("Adding new text field");const e=document.createElement("div");e.className="text-container";const t=document.createElement("div");t.className="drag-handle";const n=document.createElement("div");n.className="drag-dots",t.appendChild(n);const o=document.createElement("input");o.type="text",o.className="text-input",o.placeholder="+ テキストを追加する",o.setAttribute("inputmode","text"),o.setAttribute("enterkeyhint","done");const s=document.createElement("button");s.className="clear-button",s.textContent="✕",e.appendChild(t),e.appendChild(o),e.appendChild(s),this.textAreas.appendChild(e),this.setupClearButton(e)}setupClearButton(e){console.log("Setting up clear button");const t=e.querySelector(".clear-button"),n=e.querySelector(".text-input");if(!t||!n){console.error("Clear button or input not found in container");return}const o=()=>{console.log("Clear action triggered"),e===this.textAreas.firstElementChild?(console.log("Clearing first input value"),n.value=""):(console.log("Removing container"),e.remove())};t.addEventListener("touchend",s=>{console.log("Clear button touchend triggered"),s.preventDefault(),s.stopPropagation(),t.style.opacity="1.0",o()},{passive:!1}),t.addEventListener("click",s=>{console.log("Clear button click triggered"),s.preventDefault(),s.stopPropagation(),o()}),t.addEventListener("touchstart",s=>{console.log("Clear button touchstart triggered"),s.preventDefault(),s.stopPropagation(),t.style.opacity="0.7"},{passive:!1}),console.log("Clear button setup completed")}saveToStorage(){const e=Array.from(this.textAreas.querySelectorAll(".text-input")).map(t=>t.value);localStorage.setItem("savedTexts",JSON.stringify(e)),alert("保存しました")}loadFromStorage(){JSON.parse(localStorage.getItem("savedTexts")||"[]").forEach((t,n)=>{if(n===0)this.textAreas.querySelector(".text-input").value=t;else{this.addTextField();const o=this.textAreas.querySelectorAll(".text-input");o[o.length-1].value=t}})}clearStorage(){localStorage.removeItem("savedTexts"),Array.from(this.textAreas.querySelectorAll(".text-container")).forEach((e,t)=>{t===0?e.querySelector(".text-input").value="":e.remove()}),alert("削除しました")}startFullscreen(){console.log("Starting fullscreen mode");const e=Array.from(this.textAreas.querySelectorAll(".text-input")).map(t=>t.value).filter(t=>t.trim()!=="");if(e.length===0){console.log("No texts to display");return}if(this.isIOS()){console.log("Using native fullscreen plugin for iOS");try{if(!c)throw console.error("FullscreenPlugin is not available"),new Error("FullscreenPlugin is not initialized");console.log("Calling FullscreenPlugin.show with texts:",e),c.show({texts:e,currentIndex:0}).then(()=>{console.log("Fullscreen show successful")}).catch(t=>{console.error("Fullscreen show error:",t),this.showWebFullscreen(e)})}catch(t){console.error("Fullscreen plugin error:",t),this.showWebFullscreen(e)}return}this.showWebFullscreen(e)}showWebFullscreen(e){const t=document.getElementById("fullscreenView"),n=t.querySelector(".fullscreen-text");let o=0;const s=()=>{n.textContent=e[o]},l=a=>{o<e.length-1?(o++,s()):(t.removeEventListener("click",l),t.classList.add("hidden"))};t.addEventListener("click",l),t.classList.remove("hidden"),s()}}const i=new g;if(console.log("TextEditor initialized"),"serviceWorker"in navigator)try{const r=await navigator.serviceWorker.register("/sw.js");console.log("ServiceWorker registration successful")}catch(r){console.log("ServiceWorker registration failed:",r)}}catch(d){console.error("Application initialization error:",d)}});export{p as _};
